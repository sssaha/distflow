
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>getLineInfo</title><meta name="generator" content="MATLAB 8.3"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-11-24"><meta name="DC.source" content="getLineInfo_help.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>getLineInfo</h1><!--introduction--><p>Gets the information for all lines in the circuit</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Inputs</a></li><li><a href="#4">Outputs</a></li><li><a href="#5">Example</a></li></ul></div><h2>Syntax<a name="1"></a></h2><pre>Lines = getLineInfo(DSSCircObj);
Lines = getLineInfo(DSSCircObj, lineNames);</pre><h2>Description<a name="2"></a></h2><p>Function to get the information about the lines in the circuit and return a structure with the information. If the optional input of lineNames is filled, the function returns information for the specified subset of lines excluding the miscellaneous parameters mentioned in the outputs below.</p><h2>Inputs<a name="3"></a></h2><div><ul><li><b><tt>DSSCircObj</tt></b> - link to OpenDSS active circuit and command text (from DSSStartup)</li><li><b><tt>lineNames</tt></b> - optional cell array of line names to get information for</li></ul></div><h2>Outputs<a name="4"></a></h2><p><b><tt>Lines</tt></b> is a structure with all the parameters for the lines in the active circuit.  Fields are:</p><div><ul><li><i>name</i> - Name of the line.</li><li><i>bus1</i> - Name of the starting bus.</li><li><i>bus2</i> - Name of the ending bus.</li><li><i>enabled</i> - {1|0} indicates whether this element is enabled in the simulation.</li><li><i>bus1PhasePowerReal</i> - 3-element array of the real components of each phase's complex power at bus 1. Phases that are not present will return 0.</li><li><i>bus1PhasePowerReactive</i> - 3-element array of the imaginary components of each phase's complex power at bus 1. Phases that are not present will return 0.</li><li><i>bus2PhasePowerReal</i> - 3-element array of the real components of each phase's complex power at bus 2. Phases that are not present will return 0.</li><li><i>bus2PhasePowerReactive</i> - 3-element array of the imaginary components of each phase's complex power at bus 2. Phases that are not present will return 0.</li><li><i>bus1PowerReal</i> - Total real component at bus 1 of all present phases.</li><li><i>bus1PowerReactive</i> - Total imaginary component at bus 1 of all present phases.</li><li><i>bus2PowerReal</i> - Total real component at bus 2 of all present phases.</li><li><i>bus2PowerReactive</i> - Total imaginary component at bus 2 of all present phases.</li><li><i>bus1Current</i> - Average current magnitude for all included phases on bus 1.</li><li><i>bus2Current</i> - Average current magnitude for all included phases on bus 2.</li><li><i>bus1PhaseCurrent</i> - Current magnitude for each included phases on bus 1.</li><li><i>bus2PhaseCurrent</i> - Current magnitude for each included phases on bus 2.</li><li><i>numPhases</i> - Number of phases associated with the line.</li><li><i>numConductors</i> - Number of conductors associated with the line.</li><li><i>lineRating</i> - The line's current rating.</li><li><i>losses</i> - total real and imaginary power losses</li><li><i>phaseLosses</i> - real and imaginary power losses</li><li><i>bus1NodeOrder</i>, <i>bus1Coordinates</i>, <i>bus1Distance</i>, <i>bus1PhaseVoltages</i>,  <i>bus1PhaseVoltagesPU</i>, <i>bus1Voltage</i>, <i>bus1VoltagePU</i>, <i>bus1VoltagePhasors</i>,  <i>bus1PhaseVoltagesLL</i>, <i>bus1PhaseVoltagesLLPU</i>, - Information regarding the starting bus. All obtained from the corresponding fields of the structure returned by getBusInfo when called with 'bus1' as an input.</li><li><i>bus2NodeOrder</i>, <i>bus2Coordinates</i>, <i>bus2Distance</i>, <i>bus2PhaseVoltages</i>,  <i>bus2PhaseVoltagesPU</i>, <i>bus2Voltage</i>, <i>bus2VoltagePU</i>, <i>bus2VoltagePhasors</i>, <i>bus2PhaseVoltagePhasorsPU</i>, <i>bus2PhaseVoltagePhasorsPU</i>, <i>bus2PhaseVoltagesLL</i>, <i>bus2PhaseVoltagesLLPU</i> - Information regarding the ending bus. All obtained from the corresponding fields of the structure returned by getBusInfo when called with 'bus2' as an input.</li><li><i>parentObject</i> - name of the line or object directly upstream (parent) of the line</li><li><i>lineCode</i>, <i>length</i>, <i>R1</i>, <i>X1</i>, <i>R0</i>, <i>X0</i>, <i>C1</i>, <i>C0</i>, <i>Rmatrix</i>, <i>Xmatrix</i>, <i>Cmatrix</i>, <i>emergAmps</i>, <i>geometry</i>, <i>Rg</i>, <i>Xg</i>, <i>Rho</i>, <i>Yprim</i>, <i>numCust</i>, <i>totalCust</i>, <i>spacing</i> - OpenDSS line object properties</li></ul></div><h2>Example<a name="5"></a></h2><p>Returns line information in the circuit</p><pre class="codeinput">[DSSCircObj, DSSText, gridpvPath] = DSSStartup;
DSSText.command = [<span class="string">'Compile "'</span> gridpvPath <span class="string">'ExampleCircuit\master_Ckt24.dss"'</span>];
DSSText.command = <span class="string">'solve'</span>;
Lines = getLineInfo(DSSCircObj) <span class="comment">%Get information for all lines</span>
Lines = getLineInfo(DSSCircObj,DSSCircObj.ActiveCircuit.Lines.AllNames) <span class="comment">%Get information for all lines</span>
Lines = getLineInfo(DSSCircObj, {<span class="string">'g2102cg5800_n284428_sec_1'</span>}); <span class="comment">%Get information for a single line</span>
Lines = getLineInfo(DSSCircObj,[{<span class="string">'05410_8168450ug'</span>};{<span class="string">'05410_52308181oh'</span>}]); <span class="comment">%Get info for two lines</span>
<span class="comment">%</span>
</pre><pre class="codeoutput">
Lines = 

5221x1 struct array with fields:

    name
    bus1
    bus2
    enabled
    bus1PhasePowerReal
    bus1PhasePowerReactive
    bus2PhasePowerReal
    bus2PhasePowerReactive
    bus1PowerReal
    bus1PowerReactive
    bus2PowerReal
    bus2PowerReactive
    bus1Current
    bus2Current
    bus1PhaseCurrent
    bus2PhaseCurrent
    numPhases
    numConductors
    lineRating
    losses
    phaseLosses
    bus1NodeOrder
    bus2NodeOrder
    bus1Coordinates
    bus1Distance
    bus1CoordDefined
    bus1VoltageAngle
    bus1Voltage
    bus1VoltagePU
    bus1PhaseVoltages
    bus1PhaseVoltagesPU
    bus1PhaseVoltagePhasors
    bus1PhaseVoltagePhasorsPU
    bus1PhaseVoltagesLL
    bus1PhaseVoltagesLLPU
    bus1VoltageLL
    bus1VoltageLLPU
    bus1Zsc1
    bus1Zsc0
    bus2Coordinates
    bus2Distance
    bus2CoordDefined
    bus2VoltageAngle
    bus2Voltage
    bus2VoltagePU
    bus2PhaseVoltages
    bus2PhaseVoltagesPU
    bus2PhaseVoltagePhasors
    bus2PhaseVoltagePhasorsPU
    bus2PhaseVoltagesLL
    bus2PhaseVoltagesLLPU
    bus2VoltageLL
    bus2VoltageLLPU
    bus2Zsc1
    bus2Zsc0
    parentObject
    lineCode
    length
    R1
    X1
    R0
    X0
    C1
    C0
    Rmatrix
    Xmatrix
    Cmatrix
    emergAmps
    geometry
    Rg
    Xg
    Rho
    Yprim
    numCust
    totalCust
    spacing
    units


Lines = 

5221x1 struct array with fields:

    name
    bus1
    bus2
    enabled
    bus1PhasePowerReal
    bus1PhasePowerReactive
    bus2PhasePowerReal
    bus2PhasePowerReactive
    bus1PowerReal
    bus1PowerReactive
    bus2PowerReal
    bus2PowerReactive
    bus1Current
    bus2Current
    bus1PhaseCurrent
    bus2PhaseCurrent
    numPhases
    numConductors
    lineRating
    losses
    phaseLosses
    bus1NodeOrder
    bus2NodeOrder
    bus1Coordinates
    bus1Distance
    bus1CoordDefined
    bus1VoltageAngle
    bus1Voltage
    bus1VoltagePU
    bus1PhaseVoltages
    bus1PhaseVoltagesPU
    bus1PhaseVoltagePhasors
    bus1PhaseVoltagePhasorsPU
    bus1PhaseVoltagesLL
    bus1PhaseVoltagesLLPU
    bus1VoltageLL
    bus1VoltageLLPU
    bus1Zsc1
    bus1Zsc0
    bus2Coordinates
    bus2Distance
    bus2CoordDefined
    bus2VoltageAngle
    bus2Voltage
    bus2VoltagePU
    bus2PhaseVoltages
    bus2PhaseVoltagesPU
    bus2PhaseVoltagePhasors
    bus2PhaseVoltagePhasorsPU
    bus2PhaseVoltagesLL
    bus2PhaseVoltagesLLPU
    bus2VoltageLL
    bus2VoltageLLPU
    bus2Zsc1
    bus2Zsc0
    parentObject
    lineCode
    length
    R1
    X1
    R0
    X0
    C1
    C0
    Rmatrix
    Xmatrix
    Cmatrix
    emergAmps
    geometry
    Rg
    Xg
    Rho
    Yprim
    numCust
    totalCust
    spacing
    units

</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% getLineInfo
% Gets the information for all lines in the circuit
%
%% Syntax
%  Lines = getLineInfo(DSSCircObj);
%  Lines = getLineInfo(DSSCircObj, lineNames);
%
%% Description
% Function to get the information about the lines in the circuit and
% return a structure with the information. If the optional input of
% lineNames is filled, the function returns information for the specified
% subset of lines excluding the miscellaneous parameters mentioned in the
% outputs below.
%
%% Inputs
% * *|DSSCircObj|* - link to OpenDSS active circuit and command text (from DSSStartup)
% * *|lineNames|* - optional cell array of line names to get information for
%
%% Outputs
% *|Lines|* is a structure with all the parameters for the
% lines in the active circuit.  Fields are:
%
% * _name_ - Name of the line.
% * _bus1_ - Name of the starting bus.
% * _bus2_ - Name of the ending bus.
% * _enabled_ - {1|0} indicates whether this element is enabled in the
% simulation.
% * _bus1PhasePowerReal_ - 3-element array of the real components of each
% phase's complex power at bus 1. Phases that are not present will return 0.
% * _bus1PhasePowerReactive_ - 3-element array of the imaginary components of each
% phase's complex power at bus 1. Phases that are not present will return 0.
% * _bus2PhasePowerReal_ - 3-element array of the real components of each
% phase's complex power at bus 2. Phases that are not present will return 0.
% * _bus2PhasePowerReactive_ - 3-element array of the imaginary components of each
% phase's complex power at bus 2. Phases that are not present will return 0.
% * _bus1PowerReal_ - Total real component at bus 1 of all present phases.
% * _bus1PowerReactive_ - Total imaginary component at bus 1 of all present phases.
% * _bus2PowerReal_ - Total real component at bus 2 of all present phases.
% * _bus2PowerReactive_ - Total imaginary component at bus 2 of all present phases.
% * _bus1Current_ - Average current magnitude for all included phases on bus 1.
% * _bus2Current_ - Average current magnitude for all included phases on bus 2.
% * _bus1PhaseCurrent_ - Current magnitude for each included phases on bus 1.
% * _bus2PhaseCurrent_ - Current magnitude for each included phases on bus 2.
% * _numPhases_ - Number of phases associated with the line.
% * _numConductors_ - Number of conductors associated with the line.
% * _lineRating_ - The line's current rating.
% * _losses_ - total real and imaginary power losses
% * _phaseLosses_ - real and imaginary power losses
% * _bus1NodeOrder_, _bus1Coordinates_, _bus1Distance_, _bus1PhaseVoltages_,
%  _bus1PhaseVoltagesPU_, _bus1Voltage_, _bus1VoltagePU_, _bus1VoltagePhasors_,
%  _bus1PhaseVoltagesLL_, _bus1PhaseVoltagesLLPU_, - Information
% regarding the starting bus. All obtained from the corresponding fields of
% the structure returned by getBusInfo when called with 'bus1' as an
% input.
% * _bus2NodeOrder_, _bus2Coordinates_, _bus2Distance_, _bus2PhaseVoltages_,
%  _bus2PhaseVoltagesPU_, _bus2Voltage_, _bus2VoltagePU_, _bus2VoltagePhasors_, 
% _bus2PhaseVoltagePhasorsPU_, _bus2PhaseVoltagePhasorsPU_, _bus2PhaseVoltagesLL_,
% _bus2PhaseVoltagesLLPU_ - Information
% regarding the ending bus. All obtained from the corresponding fields of
% the structure returned by getBusInfo when called with 'bus2' as an
% input. 
% * _parentObject_ - name of the line or object directly upstream (parent) of the line
% * _lineCode_, _length_, _R1_, _X1_, _R0_, _X0_, _C1_, _C0_, _Rmatrix_,
% _Xmatrix_, _Cmatrix_, _emergAmps_, _geometry_, _Rg_, _Xg_, _Rho_,
% _Yprim_, _numCust_, _totalCust_, _spacing_ - OpenDSS line object properties
%
%%% Example
% Returns line information in the circuit
%
[DSSCircObj, DSSText, gridpvPath] = DSSStartup;
DSSText.command = ['Compile "' gridpvPath 'ExampleCircuit\master_Ckt24.dss"'];
DSSText.command = 'solve';
Lines = getLineInfo(DSSCircObj) %Get information for all lines
Lines = getLineInfo(DSSCircObj,DSSCircObj.ActiveCircuit.Lines.AllNames) %Get information for all lines
Lines = getLineInfo(DSSCircObj, {'g2102cg5800_n284428_sec_1'}); %Get information for a single line
Lines = getLineInfo(DSSCircObj,[{'05410_8168450ug'};{'05410_52308181oh'}]); %Get info for two lines
%


##### SOURCE END #####
--></body></html>