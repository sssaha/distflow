
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>getTransformerInfo</title><meta name="generator" content="MATLAB 8.3"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-11-24"><meta name="DC.source" content="getTransformerInfo_help.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>getTransformerInfo</h1><!--introduction--><p>Gets the information for all transformers in the circuit</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Inputs</a></li><li><a href="#4">Outputs</a></li><li><a href="#5">Example</a></li></ul></div><h2>Syntax<a name="1"></a></h2><pre>Transformers = getTransformerInfo(DSSCircObj)
Transformers = getTransformerInfo(DSSCircObj, transformerNames)</pre><h2>Description<a name="2"></a></h2><p>Function to get the information about the transformers in the circuit and return a structure with the information. If the optional input of transformerNames is filled, the function returns information for the specified subset of transformers, excluding the miscellaneous parameters mentioned in the outputs below.</p><h2>Inputs<a name="3"></a></h2><div><ul><li><b><tt>DSSCircObj</tt></b> - link to OpenDSS active circuit and command text (from DSSStartup)</li><li><b><tt>transformerNames</tt></b> - optional cell array of transformer names to get information for</li></ul></div><h2>Outputs<a name="4"></a></h2><p><b><tt>Transformers</tt></b> is a structure with all the parameters for the transformers in the active circuit.  Fields are:</p><div><ul><li><i>name</i> - Name of the transformer.</li><li><i>bus1</i> - Primary bus.</li><li><i>bus2</i> - Secondary bus.</li><li><i>numPhases</i> - Number of phases associated with the transformer.</li><li><i>enabled</i> - {1|0} indicates whether this element is enabled in the simulation.</li><li><i>bus1PhasePowerReal</i> - 3-element array of the real components of each phase's complex power at bus 1. Phases that are not present will return 0.</li><li><i>bus1PhasePowerReactive</i> - 3-element array of the imaginary components of each phase's complex power at bus 1. Phases that are not present will return 0.</li><li><i>bus2PhasePowerReal</i> - 3-element array of the real components of each phase's complex power at bus 2. Phases that are not present will return 0.</li><li><i>bus2PhasePowerReactive</i> - 3-element array of the imaginary components of each phase's complex power at bus 2. Phases that are not present will return 0.</li><li><i>bus1PowerReal</i> - Total real component at bus 1 of all present phases.</li><li><i>bus1PowerReactive</i> - Total imaginary component at bus 1 of all present phases.</li><li><i>bus2PowerReal</i> - Total real component at bus 2 of all present phases.</li><li><i>bus2PowerReactive</i> - Total imaginary component at bus 2 of all present phases.</li><li><i>bus1NodeOrder</i>, <i>bus1Coordinates</i>, <i>bus1Distance</i>, <i>bus1PhaseVoltages</i>,  <i>bus1PhaseVoltagesPU</i>, <i>bus1Voltage</i>, <i>bus1VoltagePU</i>, <i>bus1VoltagePhasors</i>,  <i>bus1PhaseVoltagesLL</i>, <i>bus1PhaseVoltagesLLPU</i>, - Information regarding the starting bus. All obtained from the corresponding fields of the structure returned by getBusInfo when called with 'bus1' as an input.</li><li><i>bus2NodeOrder</i>, <i>bus2Coordinates</i>, <i>bus2Distance</i>, <i>bus2PhaseVoltages</i>,  <i>bus2PhaseVoltagesPU</i>, <i>bus2Voltage</i>, <i>bus2VoltagePU</i>, <i>bus2VoltagePhasors</i>, <i>bus2PhaseVoltagePhasorsPU</i>, <i>bus2PhaseVoltagePhasorsPU</i>, <i>bus2PhaseVoltagesLL</i>, <i>bus2PhaseVoltagesLLPU</i> - Information regarding the ending bus. All obtained from the corresponding fields of the structure returned by getBusInfo when called with 'bus2' as an input.</li><li><i>losses</i> - total real and imaginary power losses</li><li><i>phaseLosses</i> - real and imaginary power losses</li><li><i>seqVoltages</i>, <i>cplxVoltages</i>, <i>seqCurrents</i>, <i>cplxSeqCurrents</i> - zero, positive, and negative sequence voltages and currents magnitude or complex phasors</li><li><i>inputkva</i> - apparent power magnitude coming into the transformer</li><li><i>controlled</i> - Whether or not the transformer is tap-controlled.</li><li><i>kva</i> - Transformer power rating.</li><li><i>XfmrCode</i> - name of the transformer code if one is assigned</li><li><i>wdg1R</i>, <i>wdg1Tap</i>, <i>wdg1minTap</i>, <i>wdg1maxTap</i>, <i>wdg1numTaps</i>, <i>bus1kV</i>, <i>isDelta</i> - properties for the first winding of the transformer.  All properties exist for the wdg2 side as well</li><li><i>Xneut</i>, <i>Rneut</i>, <i>Xhl</i>, <i>Xht</i>, <i>PCTnoLoadLoss</i> - OpenDSS Transformer properties</li><li><i>CTPrimary</i>, <i>delay</i>, <i>forwardBand</i>, <i>forwardR</i>, <i>forwardVreg</i>, <i>forwardX</i>, <i>isInverseTime</i>, <i>_isReversible</i>, <i>maxTapChange</i>, <i>monitoredBus</i>, <i>PTratio</i>, <i>reverseBand</i>, <i>reverseR</i>, <i>reverseVreg</i>, <i>reverseX</i>, <i>tapDelay</i>, <i>tapWinding</i>, <i>voltageLimit</i>, <i>winding</i> - OpenDSS properties for the RegControl object for transformers on which one is present</li></ul></div><h2>Example<a name="5"></a></h2><p>Returns transformer information in the circuit</p><pre class="codeinput">[DSSCircObj, DSSText, gridpvPath] = DSSStartup;
DSSText.command = [<span class="string">'Compile "'</span> gridpvPath <span class="string">'ExampleCircuit\master_Ckt24.dss"'</span>];
DSSText.command = <span class="string">'solve'</span>;
Transformers = getTransformerInfo(DSSCircObj) <span class="comment">%Get information for all transformers</span>
Transformers = getTransformerInfo(DSSCircObj,DSSCircObj.ActiveCircuit.Transformers.AllNames) <span class="comment">%Get information for all transformers</span>
Transformers = getTransformerInfo(DSSCircObj, {<span class="string">'05410_g2101ak7700'</span>}) <span class="comment">%Get information for one transformer</span>
Transformers = getTransformerInfo(DSSCircObj, [{<span class="string">'05410_g2101ah4300'</span>};{<span class="string">'05410_g2101ae2300'</span>}]); <span class="comment">%Get information for two transformers</span>
<span class="comment">%</span>
</pre><pre class="codeoutput">
Transformers = 

843x1 struct array with fields:

    name
    bus1
    bus2
    numPhases
    enabled
    bus1PhasePowerReal
    bus1PhasePowerReactive
    bus2PhasePowerReal
    bus2PhasePowerReactive
    bus1PowerReal
    bus1PowerReactive
    bus2PowerReal
    bus2PowerReactive
    bus1NodeOrder
    bus2NodeOrder
    bus1Voltage
    bus1VoltagePU
    bus1PhaseVoltages
    bus1PhaseVoltagesPU
    bus1PhaseVoltagePhasors
    bus1PhaseVoltagePhasorsPU
    bus1PhaseVoltagesLL
    bus1PhaseVoltagesLLPU
    bus1VoltageLL
    bus1VoltageLLPU
    bus2Voltage
    bus2VoltagePU
    bus2PhaseVoltages
    bus2PhaseVoltagesPU
    bus2PhaseVoltagePhasors
    bus2PhaseVoltagePhasorsPU
    bus2PhaseVoltagesLL
    bus2PhaseVoltagesLLPU
    bus2VoltageLL
    bus2VoltageLLPU
    bus1Distance
    bus2Distance
    losses
    phaseLosses
    seqVoltages
    cplxSeqVoltages
    seqCurrents
    cplxSeqCurrents
    seqPower
    inputkva
    controlled
    kva
    XfmrCode
    wdg1R
    wdg1Tap
    wdg1minTap
    wdg1maxTap
    wdg1numTaps
    bus1kV
    Xneut
    Rneut
    wdg1IsDelta
    Xhl
    Xht
    bus2kV
    wdg2R
    wdg2Tap
    wdg2minTap
    wdg2maxTap
    wdg2numTaps
    wdg2IsDelta
    PCTloadLoss
    PCTnoLoadLoss
    controller
    CTPrimary
    delay
    forwardBand
    forwardR
    forwardVreg
    forwardX
    isInverseTime
    isReversible
    maxTapChange
    monitoredBus
    PTratio
    reverseBand
    reverseR
    reverseVreg
    reverseX
    tapDelay
    tapWinding
    voltageLimit
    winding


Transformers = 

843x1 struct array with fields:

    name
    bus1
    bus2
    numPhases
    enabled
    bus1PhasePowerReal
    bus1PhasePowerReactive
    bus2PhasePowerReal
    bus2PhasePowerReactive
    bus1PowerReal
    bus1PowerReactive
    bus2PowerReal
    bus2PowerReactive
    bus1NodeOrder
    bus2NodeOrder
    bus1Voltage
    bus1VoltagePU
    bus1PhaseVoltages
    bus1PhaseVoltagesPU
    bus1PhaseVoltagePhasors
    bus1PhaseVoltagePhasorsPU
    bus1PhaseVoltagesLL
    bus1PhaseVoltagesLLPU
    bus1VoltageLL
    bus1VoltageLLPU
    bus2Voltage
    bus2VoltagePU
    bus2PhaseVoltages
    bus2PhaseVoltagesPU
    bus2PhaseVoltagePhasors
    bus2PhaseVoltagePhasorsPU
    bus2PhaseVoltagesLL
    bus2PhaseVoltagesLLPU
    bus2VoltageLL
    bus2VoltageLLPU
    bus1Distance
    bus2Distance
    losses
    phaseLosses
    seqVoltages
    cplxSeqVoltages
    seqCurrents
    cplxSeqCurrents
    seqPower
    inputkva
    controlled
    kva
    XfmrCode
    wdg1R
    wdg1Tap
    wdg1minTap
    wdg1maxTap
    wdg1numTaps
    bus1kV
    Xneut
    Rneut
    wdg1IsDelta
    Xhl
    Xht
    bus2kV
    wdg2R
    wdg2Tap
    wdg2minTap
    wdg2maxTap
    wdg2numTaps
    wdg2IsDelta
    PCTloadLoss
    PCTnoLoadLoss
    controller
    CTPrimary
    delay
    forwardBand
    forwardR
    forwardVreg
    forwardX
    isInverseTime
    isReversible
    maxTapChange
    monitoredBus
    PTratio
    reverseBand
    reverseR
    reverseVreg
    reverseX
    tapDelay
    tapWinding
    voltageLimit
    winding


Transformers = 

                         name: '05410_g2101ak7700'
                         bus1: 'n284223.1'
                         bus2: 'g2101ak7700_n284223_sec.1'
                    numPhases: 1
                      enabled: 1
           bus1PhasePowerReal: [18.7850 0 0]
       bus1PhasePowerReactive: [4.1436 0 0]
           bus2PhasePowerReal: [-18.6304 0 0]
       bus2PhasePowerReactive: [-3.7457 0 0]
                bus1PowerReal: 18.7850
            bus1PowerReactive: 4.1436
                bus2PowerReal: -18.6304
            bus2PowerReactive: -3.7457
                bus1NodeOrder: 1
                bus2NodeOrder: 1
                  bus1Voltage: 7.6399e+03
                bus1VoltagePU: 1.0025
            bus1PhaseVoltages: [7.6399e+03 0 0]
          bus1PhaseVoltagesPU: [1.0025 0 0]
      bus1PhaseVoltagePhasors: [1x3 double]
    bus1PhaseVoltagePhasorsPU: [1x3 double]
          bus1PhaseVoltagesLL: [7.6399e+03 0 0]
        bus1PhaseVoltagesLLPU: [1.0025 0 0]
                bus1VoltageLL: 7.6399e+03
              bus1VoltageLLPU: 1.0025
                  bus2Voltage: 239.4107
                bus2VoltagePU: 0.9992
            bus2PhaseVoltages: [239.4107 0 0]
          bus2PhaseVoltagesPU: [0.9992 0 0]
      bus2PhaseVoltagePhasors: [1x3 double]
    bus2PhaseVoltagePhasorsPU: [1x3 double]
          bus2PhaseVoltagesLL: [239.4107 0 0]
        bus2PhaseVoltagesLLPU: [0.9992 0 0]
                bus2VoltageLL: 239.4107
              bus2VoltageLLPU: 0.9992
                 bus1Distance: 7.5266
                 bus2Distance: 7.5266
                       losses: 0.1546 + 0.3980i
                  phaseLosses: 0.1546 + 0.3980i
                  seqVoltages: [1 1 1 1 1 1]
              cplxSeqVoltages: [-1 0 -1 0 -1 0 -1 0 -1 0 -1 0]
                  seqCurrents: [1 1 1 1 1 1]
              cplxSeqCurrents: [-1 0 -1 0 -1 0 -1 0 -1 0 -1 0]
                     seqPower: [-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1]
                     inputkva: 19.2366
                   controlled: 0
                          kva: 50
                     XfmrCode: ''
                        wdg1R: 0.0044
                      wdg1Tap: 1
                   wdg1minTap: 0.9000
                   wdg1maxTap: 1.1000
                  wdg1numTaps: 32
                       bus1kV: 7.6210
                        Xneut: 0
                        Rneut: -1
                  wdg1IsDelta: 0
                          Xhl: 0.0203
                          Xht: 0.3000
                       bus2kV: 0.2400
                        wdg2R: 0.0044
                      wdg2Tap: 1
                   wdg2minTap: 0.9000
                   wdg2maxTap: 1.1000
                  wdg2numTaps: 32
                  wdg2IsDelta: 0
                  PCTloadLoss: 0.8770
                PCTnoLoadLoss: 0.8770

</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% getTransformerInfo
% Gets the information for all transformers in the circuit
%
%% Syntax
%  Transformers = getTransformerInfo(DSSCircObj)
%  Transformers = getTransformerInfo(DSSCircObj, transformerNames)
%
%% Description
% Function to get the information about the transformers in the circuit and
% return a structure with the information. If the optional input of
% transformerNames is filled, the function returns information for the specified
% subset of transformers, excluding the miscellaneous parameters mentioned
% in the outputs below.
%
%% Inputs
% * *|DSSCircObj|* - link to OpenDSS active circuit and command text (from DSSStartup)
% * *|transformerNames|* - optional cell array of transformer names to get information for
%
%% Outputs
% *|Transformers|* is a structure with all the parameters for the
% transformers in the active circuit.  Fields are:
%
% * _name_ - Name of the transformer.
% * _bus1_ - Primary bus.
% * _bus2_ - Secondary bus.
% * _numPhases_ - Number of phases associated with the transformer.
% * _enabled_ - {1|0} indicates whether this element is enabled in the simulation.
% * _bus1PhasePowerReal_ - 3-element array of the real components of each
% phase's complex power at bus 1. Phases that are not present will return 0.
% * _bus1PhasePowerReactive_ - 3-element array of the imaginary components of each
% phase's complex power at bus 1. Phases that are not present will return 0.
% * _bus2PhasePowerReal_ - 3-element array of the real components of each
% phase's complex power at bus 2. Phases that are not present will return 0.
% * _bus2PhasePowerReactive_ - 3-element array of the imaginary components of each
% phase's complex power at bus 2. Phases that are not present will return 0.
% * _bus1PowerReal_ - Total real component at bus 1 of all present phases.
% * _bus1PowerReactive_ - Total imaginary component at bus 1 of all present phases.
% * _bus2PowerReal_ - Total real component at bus 2 of all present phases.
% * _bus2PowerReactive_ - Total imaginary component at bus 2 of all present phases.
% * _bus1NodeOrder_, _bus1Coordinates_, _bus1Distance_, _bus1PhaseVoltages_,
%  _bus1PhaseVoltagesPU_, _bus1Voltage_, _bus1VoltagePU_, _bus1VoltagePhasors_,
%  _bus1PhaseVoltagesLL_, _bus1PhaseVoltagesLLPU_, - Information
% regarding the starting bus. All obtained from the corresponding fields of
% the structure returned by getBusInfo when called with 'bus1' as an
% input.
% * _bus2NodeOrder_, _bus2Coordinates_, _bus2Distance_, _bus2PhaseVoltages_,
%  _bus2PhaseVoltagesPU_, _bus2Voltage_, _bus2VoltagePU_, _bus2VoltagePhasors_, 
% _bus2PhaseVoltagePhasorsPU_, _bus2PhaseVoltagePhasorsPU_, _bus2PhaseVoltagesLL_,
% _bus2PhaseVoltagesLLPU_ - Information
% regarding the ending bus. All obtained from the corresponding fields of
% the structure returned by getBusInfo when called with 'bus2' as an
% input. 
% * _losses_ - total real and imaginary power losses
% * _phaseLosses_ - real and imaginary power losses
% * _seqVoltages_, _cplxVoltages_, _seqCurrents_, _cplxSeqCurrents_ - zero, positive, and negative sequence voltages and currents magnitude or complex phasors
% * _inputkva_ - apparent power magnitude coming into the transformer
% * _controlled_ - Whether or not the transformer is tap-controlled.
% * _kva_ - Transformer power rating.
% * _XfmrCode_ - name of the transformer code if one is assigned
% * _wdg1R_, _wdg1Tap_, _wdg1minTap_, _wdg1maxTap_, _wdg1numTaps_, _bus1kV_, _isDelta_ - properties for the first winding of the transformer.  All properties exist for the wdg2 side as well
% * _Xneut_, _Rneut_, _Xhl_, _Xht_, _PCTnoLoadLoss_ - OpenDSS Transformer properties
% * _CTPrimary_, _delay_, _forwardBand_, _forwardR_, _forwardVreg_, _forwardX_, _isInverseTime_, __isReversible_, _maxTapChange_, _monitoredBus_,
% _PTratio_, _reverseBand_, _reverseR_, _reverseVreg_, _reverseX_, _tapDelay_, _tapWinding_, _voltageLimit_, _winding_ - OpenDSS properties for the RegControl object for transformers on which one is present
%
%%% Example
% Returns transformer information in the circuit
%
[DSSCircObj, DSSText, gridpvPath] = DSSStartup;
DSSText.command = ['Compile "' gridpvPath 'ExampleCircuit\master_Ckt24.dss"'];
DSSText.command = 'solve';
Transformers = getTransformerInfo(DSSCircObj) %Get information for all transformers
Transformers = getTransformerInfo(DSSCircObj,DSSCircObj.ActiveCircuit.Transformers.AllNames) %Get information for all transformers
Transformers = getTransformerInfo(DSSCircObj, {'05410_g2101ak7700'}) %Get information for one transformer
Transformers = getTransformerInfo(DSSCircObj, [{'05410_g2101ah4300'};{'05410_g2101ae2300'}]); %Get information for two transformers
%


##### SOURCE END #####
--></body></html>